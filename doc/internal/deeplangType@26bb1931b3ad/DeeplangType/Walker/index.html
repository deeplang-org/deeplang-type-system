<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Walker (deeplangType@26bb1931b3ad.DeeplangType.Walker)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">deeplangType@26bb1931b3ad</a> &#x00BB; <a href="../index.html">DeeplangType</a> &#x00BB; Walker</nav><header class="odoc-preamble"><h1>Module <code><span>DeeplangType.Walker</span></code></h1><p>This module walks AST from <a href="../ParseTree/index.html"><code>ParseTree</code></a>, to do <b>name resolution</b> and <b>type checking</b> in one pass.</p><p>Programmer should read from the <a href="#interface">Interface</a>.</p></header><nav class="odoc-toc"><ul><li><a href="#types">Types</a></li><li><a href="#implementation">Implementation</a></li><li><a href="#interface">Interface</a></li><li><a href="#todo:test-helper">TODO:Test Helper</a></li></ul></nav><div class="odoc-content"><h2 id="types"><a href="#types" class="anchor"></a>Types</h2><div class="odoc-spec"><div class="spec module" id="module-NameMap" class="anchored"><a href="#module-NameMap" class="anchor"></a><code><span><span class="keyword">module</span> <a href="NameMap/index.html">NameMap</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-name_map" class="anchored"><a href="#type-name_map" class="anchor"></a><code><span><span class="keyword">type</span> name_map</span><span> = <span><a href="../ParseTree/index.html#type-symbol">ParseTree.symbol</a> <a href="NameMap/index.html#type-t">NameMap.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-context" class="anchored"><a href="#type-context" class="anchor"></a><code><span><span class="keyword">type</span> context</span><span> = </span><span>{</span></code><table><tr id="type-context.name_map" class="anchored"><td class="def record field"><a href="#type-context.name_map" class="anchor"></a><code><span><span class="keyword">mutable</span> name_map : <a href="#type-name_map">name_map</a>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-layered_name_map" class="anchored"><a href="#type-layered_name_map" class="anchor"></a><code><span><span class="keyword">type</span> layered_name_map</span><span> = </span><span>{</span></code><table><tr id="type-layered_name_map.deep" class="anchored"><td class="def record field"><a href="#type-layered_name_map.deep" class="anchor"></a><code><span><span class="keyword">mutable</span> deep : <a href="#type-name_map">name_map</a>;</span></code></td></tr><tr id="type-layered_name_map.shallow" class="anchored"><td class="def record field"><a href="#type-layered_name_map.shallow" class="anchor"></a><code><span><span class="keyword">mutable</span> shallow : <a href="#type-name_map">name_map</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>helps to forbide variable with the same names in one scope</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>TODO:<code>layered_name_map</code></p></div></div><div class="odoc-spec"><div class="spec type" id="type-var_data" class="anchored"><a href="#type-var_data" class="anchor"></a><code><span><span class="keyword">type</span> var_data</span><span> = </span><span>{</span></code><table><tr id="type-var_data.mut" class="anchored"><td class="def record field"><a href="#type-var_data.mut" class="anchor"></a><code><span>mut : <a href="../ParseTree/index.html#type-mutability">ParseTree.mutability</a>;</span></code></td></tr><tr id="type-var_data.typ" class="anchored"><td class="def record field"><a href="#type-var_data.typ" class="anchor"></a><code><span>typ : <a href="../ParseTree/index.html#type-typ">ParseTree.typ</a>;</span></code></td></tr><tr id="type-var_data.name" class="anchored"><td class="def record field"><a href="#type-var_data.name" class="anchor"></a><code><span>name : <a href="../ParseTree/index.html#type-variable">ParseTree.variable</a>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-var_table" class="anchored"><a href="#type-var_table" class="anchor"></a><code><span><span class="keyword">type</span> var_table</span><span> = <span><span>( <a href="../ParseTree/index.html#type-symbol">ParseTree.symbol</a>, <a href="#type-var_data">var_data</a> )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-fun_data" class="anchored"><a href="#type-fun_data" class="anchor"></a><code><span><span class="keyword">type</span> fun_data</span><span> = </span><span>{</span></code><table><tr id="type-fun_data.args" class="anchored"><td class="def record field"><a href="#type-fun_data.args" class="anchor"></a><code><span>args : <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> list</span>;</span></code></td></tr><tr id="type-fun_data.retv" class="anchored"><td class="def record field"><a href="#type-fun_data.retv" class="anchor"></a><code><span>retv : <a href="../ParseTree/index.html#type-typ">ParseTree.typ</a>;</span></code></td></tr><tr id="type-fun_data.name" class="anchored"><td class="def record field"><a href="#type-fun_data.name" class="anchor"></a><code><span>name : <span><a href="../ParseTree/index.html#type-variable">ParseTree.variable</a> list</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-fun_table" class="anchored"><a href="#type-fun_table" class="anchor"></a><code><span><span class="keyword">type</span> fun_table</span><span> = <span><span>( <a href="../ParseTree/index.html#type-func_name">ParseTree.func_name</a>, <a href="#type-fun_data">fun_data</a> )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-adty_data" class="anchored"><a href="#type-adty_data" class="anchor"></a><code><span><span class="keyword">type</span> adty_data</span><span> = </span><span>{</span></code><table><tr id="type-adty_data.intf" class="anchored"><td class="def record field"><a href="#type-adty_data.intf" class="anchor"></a><code><span><span class="keyword">mutable</span> intf : <span><a href="../ParseTree/index.html#type-intf_name">ParseTree.intf_name</a> list</span>;</span></code></td></tr><tr id="type-adty_data.meth" class="anchored"><td class="def record field"><a href="#type-adty_data.meth" class="anchor"></a><code><span><span class="keyword">mutable</span> meth : <a href="#type-fun_table">fun_table</a>;</span></code></td></tr><tr id="type-adty_data.core" class="anchored"><td class="def record field"><a href="#type-adty_data.core" class="anchor"></a><code><span>core : <span><span>(<a href="../ParseTree/index.html#type-adt_label">ParseTree.adt_label</a> * <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> list</span>)</span> list</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-is_delegated" class="anchored"><a href="#type-is_delegated" class="anchor"></a><code><span><span class="keyword">type</span> is_delegated</span><span> = </span></code><table><tr id="type-is_delegated.IsDelegated" class="anchored"><td class="def variant constructor"><a href="#type-is_delegated.IsDelegated" class="anchor"></a><code><span>| </span><span><span class="constructor">IsDelegated</span></span></code></td></tr><tr id="type-is_delegated.JustMember" class="anchored"><td class="def variant constructor"><a href="#type-is_delegated.JustMember" class="anchor"></a><code><span>| </span><span><span class="constructor">JustMember</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-field_data" class="anchored"><a href="#type-field_data" class="anchor"></a><code><span><span class="keyword">type</span> field_data</span><span> = </span><span>{</span></code><table><tr id="type-field_data.typ" class="anchored"><td class="def record field"><a href="#type-field_data.typ" class="anchor"></a><code><span>typ : <a href="../ParseTree/index.html#type-typ">ParseTree.typ</a>;</span></code></td></tr><tr id="type-field_data.delegated" class="anchored"><td class="def record field"><a href="#type-field_data.delegated" class="anchor"></a><code><span>delegated : <a href="#type-is_delegated">is_delegated</a>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-struct_data" class="anchored"><a href="#type-struct_data" class="anchor"></a><code><span><span class="keyword">type</span> struct_data</span><span> = </span><span>{</span></code><table><tr id="type-struct_data.intf" class="anchored"><td class="def record field"><a href="#type-struct_data.intf" class="anchor"></a><code><span><span class="keyword">mutable</span> intf : <span><a href="../ParseTree/index.html#type-intf_name">ParseTree.intf_name</a> list</span>;</span></code></td></tr><tr id="type-struct_data.meth" class="anchored"><td class="def record field"><a href="#type-struct_data.meth" class="anchor"></a><code><span><span class="keyword">mutable</span> meth : <a href="#type-fun_table">fun_table</a>;</span></code></td></tr><tr id="type-struct_data.core" class="anchored"><td class="def record field"><a href="#type-struct_data.core" class="anchor"></a><code><span>core : <span><span>( <a href="../ParseTree/index.html#type-struct_field">ParseTree.struct_field</a>, <a href="#type-field_data">field_data</a> )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span>;</span></code></td></tr><tr id="type-struct_data.fields" class="anchored"><td class="def record field"><a href="#type-struct_data.fields" class="anchor"></a><code><span>fields : <span><a href="../ParseTree/index.html#type-struct_def_field">ParseTree.struct_def_field</a> list</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-intf_data" class="anchored"><a href="#type-intf_data" class="anchor"></a><code><span><span class="keyword">type</span> intf_data</span><span> = </span><span>{</span></code><table><tr id="type-intf_data.meth" class="anchored"><td class="def record field"><a href="#type-intf_data.meth" class="anchor"></a><code><span>meth : <a href="#type-fun_table">fun_table</a>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-typ_data" class="anchored"><a href="#type-typ_data" class="anchor"></a><code><span><span class="keyword">type</span> typ_data</span><span> = </span></code><table><tr id="type-typ_data.ADT_data" class="anchored"><td class="def variant constructor"><a href="#type-typ_data.ADT_data" class="anchor"></a><code><span>| </span><span><span class="constructor">ADT_data</span> <span class="keyword">of</span> <a href="#type-adty_data">adty_data</a></span></code></td></tr><tr id="type-typ_data.Struct_data" class="anchored"><td class="def variant constructor"><a href="#type-typ_data.Struct_data" class="anchor"></a><code><span>| </span><span><span class="constructor">Struct_data</span> <span class="keyword">of</span> <a href="#type-struct_data">struct_data</a></span></code></td></tr><tr id="type-typ_data.Intf_data" class="anchored"><td class="def variant constructor"><a href="#type-typ_data.Intf_data" class="anchor"></a><code><span>| </span><span><span class="constructor">Intf_data</span> <span class="keyword">of</span> <a href="#type-intf_data">intf_data</a></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-typ_table" class="anchored"><a href="#type-typ_table" class="anchor"></a><code><span><span class="keyword">type</span> typ_table</span><span> = <span><span>( <a href="../ParseTree/index.html#type-typ_name">ParseTree.typ_name</a>, <a href="#type-typ_data">typ_data</a> )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-adt_data" class="anchored"><a href="#type-adt_data" class="anchor"></a><code><span><span class="keyword">type</span> adt_data</span><span> = </span><span>{</span></code><table><tr id="type-adt_data.sum" class="anchored"><td class="def record field"><a href="#type-adt_data.sum" class="anchor"></a><code><span>sum : <a href="../ParseTree/index.html#type-typ_name">ParseTree.typ_name</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>sum_type's name</p><span class="comment-delim">*)</span></td></tr><tr id="type-adt_data.typ" class="anchored"><td class="def record field"><a href="#type-adt_data.typ" class="anchor"></a><code><span>typ : <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> list</span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>parameters of constructor</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-adt_table" class="anchored"><a href="#type-adt_table" class="anchor"></a><code><span><span class="keyword">type</span> adt_table</span><span> = <span><span>( <a href="../ParseTree/index.html#type-adt_label">ParseTree.adt_label</a>, <a href="#type-adt_data">adt_data</a> )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-ref_data" class="anchored"><a href="#type-ref_data" class="anchor"></a><code><span><span class="keyword">type</span> ref_data</span><span> = </span><span>{</span></code><table><tr id="type-ref_data.sym" class="anchored"><td class="def record field"><a href="#type-ref_data.sym" class="anchor"></a><code><span>sym : <a href="../ParseTree/index.html#type-symbol">ParseTree.symbol</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>point to the varaible</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-ref_table" class="anchored"><a href="#type-ref_table" class="anchor"></a><code><span><span class="keyword">type</span> ref_table</span><span> = <span><span>( <a href="../ParseTree/NodeId/index.html#type-expr">ParseTree.NodeId.expr</a>, <a href="#type-ref_data">ref_data</a> )</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-table" class="anchored"><a href="#type-table" class="anchor"></a><code><span><span class="keyword">type</span> table</span><span> = </span><span>{</span></code><table><tr id="type-table.var" class="anchored"><td class="def record field"><a href="#type-table.var" class="anchor"></a><code><span>var : <a href="#type-var_table">var_table</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>the mutability, type and name of variable</p><span class="comment-delim">*)</span></td></tr><tr id="type-table.fnc" class="anchored"><td class="def record field"><a href="#type-table.fnc" class="anchor"></a><code><span>fnc : <a href="#type-fun_table">fun_table</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>the signature/type of function</p><span class="comment-delim">*)</span></td></tr><tr id="type-table.typ" class="anchored"><td class="def record field"><a href="#type-table.typ" class="anchor"></a><code><span>typ : <a href="#type-typ_table">typ_table</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>the info of adt, struct and interface</p><span class="comment-delim">*)</span></td></tr><tr id="type-table.adt" class="anchored"><td class="def record field"><a href="#type-table.adt" class="anchor"></a><code><span>adt : <a href="#type-adt_table">adt_table</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>the signature/type of adt_labels/constructor</p><span class="comment-delim">*)</span></td></tr><tr id="type-table.ref" class="anchored"><td class="def record field"><a href="#type-table.ref" class="anchor"></a><code><span>ref : <a href="#type-ref_table">ref_table</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>the use of variable</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-BuiltinType" class="anchored"><a href="#module-BuiltinType" class="anchor"></a><code><span><span class="keyword">module</span> <a href="BuiltinType/index.html">BuiltinType</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="BuiltinType/index.html"><code>BuiltinType</code></a> used in walker, which is not yet defined in <code>ParsingTree</code></p></div></div><h2 id="implementation"><a href="#implementation" class="anchor"></a>Implementation</h2><div class="odoc-spec"><div class="spec value" id="val-walk_add_variable" class="anchored"><a href="#val-walk_add_variable" class="anchor"></a><code><span><span class="keyword">val</span> walk_add_variable : 
  <span><a href="../ParseTree/index.html#type-symbol">ParseTree.symbol</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-mutability">ParseTree.mutability</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-variable">ParseTree.variable</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-layered_name_map">layered_name_map</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>add variable in table and name_map.deep, .shallow</p></div></div><div class="odoc-spec"><div class="spec value" id="val-walk_pattern" class="anchored"><a href="#val-walk_pattern" class="anchor"></a><code><span><span class="keyword">val</span> walk_pattern : 
  <span><a href="../ParseTree/index.html#type-pattern">ParseTree.pattern</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-layered_name_map">layered_name_map</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>call walk_add_variable</p><pre><code># walk_pattern pattern typ table layered_name_map</code></pre><p><code>typ</code> is the type of expr corresponding to <code>pattern</code></p><p>In <code> let (x, _) = (3, 1.1) </code>, <code>pattern</code> is <code>(x, _)</code>, and <code>typ</code> is <code>(i64, f64)</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-walk_expr" class="anchored"><a href="#val-walk_expr" class="anchor"></a><code><span><span class="keyword">val</span> walk_expr : 
  <span><a href="../ParseTree/index.html#type-expr">ParseTree.expr</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-name_map">name_map</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="../ParseTree/index.html#type-typ">ParseTree.typ</a></span></code></div><div class="spec-doc"><p>Type Check implemented in <code>walk_expr</code>:</p><pre><code># let ty = walk_expr expr table name_map type_this 
  val ty : typ = &lt;...&gt;</code></pre><p><code>type_this</code> is the type of <code>this</code> when in method scope.</p><p><code>ty</code> is the type of expr.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-walk_stmt" class="anchored"><a href="#val-walk_stmt" class="anchor"></a><code><span><span class="keyword">val</span> walk_stmt : 
  <span><a href="../ParseTree/index.html#type-stmt">ParseTree.stmt</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-layered_name_map">layered_name_map</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> option</span></span></code></div><div class="spec-doc"><p>walk stmt with checking the return type</p><pre><code># let typo' = walk_stmt stmt table layered_name_map type_this typo
  val typo' : typ option = &lt;...&gt;</code></pre><p><code>typo</code> and <code>typo'</code> are the return type of <code>expr</code> in <code>return expr</code>.</p><pre><code>match typo with
| None     -&gt; have walked no          return-stmts yet
| Some(ty) -&gt; have walked one or more return-stmts and
              their return types are all ty</code></pre><p>When meeting a return-stmt, check <code>typo</code> to ensure unique return type.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-walk_func_decl" class="anchored"><a href="#val-walk_func_decl" class="anchor"></a><code><span><span class="keyword">val</span> walk_func_decl : 
  <span><a href="../ParseTree/index.html#type-func_name">ParseTree.func_name</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../ParseTree/index.html#type-func_arg">ParseTree.func_arg</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>check func name, and collect type info</p><pre><code># walk_func_decl name parameters return_type table</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-walk_func_stmt" class="anchored"><a href="#val-walk_func_stmt" class="anchor"></a><code><span><span class="keyword">val</span> walk_func_stmt : 
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../ParseTree/index.html#type-func_arg">ParseTree.func_arg</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-stmt">ParseTree.stmt</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-name_map">name_map</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> option</span></span></code></div><div class="spec-doc"><p>simply walk function's body inductively</p></div></div><div class="odoc-spec"><div class="spec value" id="val-walk_method_intf" class="anchored"><a href="#val-walk_method_intf" class="anchor"></a><code><span><span class="keyword">val</span> walk_method_intf : 
  <span><span><a href="../ParseTree/index.html#type-intf_name">ParseTree.intf_name</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-typ_name">ParseTree.typ_name</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>impl intf for T with methods, check whether intf exists and whether it has such methods</p></div></div><div class="odoc-spec"><div class="spec value" id="val-walk_method_decl" class="anchored"><a href="#val-walk_method_decl" class="anchor"></a><code><span><span class="keyword">val</span> walk_method_decl : 
  <span><a href="../ParseTree/index.html#type-typ_name">ParseTree.typ_name</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-func_name">ParseTree.func_name</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../ParseTree/index.html#type-func_arg">ParseTree.func_arg</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>similar to <a href="#val-walk_func_decl"><code>walk_func_decl</code></a>, but checked in the scope of type T</p></div></div><div class="odoc-spec"><div class="spec value" id="val-walk_method_stmt" class="anchored"><a href="#val-walk_method_stmt" class="anchor"></a><code><span><span class="keyword">val</span> walk_method_stmt : 
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../ParseTree/index.html#type-func_arg">ParseTree.func_arg</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-stmt">ParseTree.stmt</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-name_map">name_map</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../ParseTree/index.html#type-typ">ParseTree.typ</a> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-walk_top" class="anchored"><a href="#val-walk_top" class="anchor"></a><code><span><span class="keyword">val</span> walk_top : <span><a href="../ParseTree/index.html#type-top_clause">ParseTree.top_clause</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-name_map">name_map</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-name_map">name_map</a></span></code></div></div><h2 id="interface"><a href="#interface" class="anchor"></a>Interface</h2><div class="odoc-spec"><div class="spec value" id="val-walk" class="anchored"><a href="#val-walk" class="anchor"></a><code><span><span class="keyword">val</span> walk : <span><a href="#type-context">context</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-table">table</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../ParseTree/index.html#type-top_clause">ParseTree.top_clause</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><a href="#type-context"><code>context</code></a> is mutable, mapping variable names to symbols.</p><p><a href="#type-table"><code>table</code></a> is mutable, produced by <a href="#val-walk"><code>walk</code></a>.</p><p>Indeed, <a href="#val-walk"><code>walk</code></a> is just a wrap of <a href="#val-walk_top"><code>walk_top</code></a>, see the code.</p></div></div><h2 id="todo:test-helper"><a href="#todo:test-helper" class="anchor"></a>TODO:Test Helper</h2><div class="odoc-spec"><div class="spec value" id="val-mk_id" class="anchored"><a href="#val-mk_id" class="anchor"></a><code><span><span class="keyword">val</span> mk_id : <span>unit <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-test_span" class="anchored"><a href="#val-test_span" class="anchor"></a><code><span><span class="keyword">val</span> test_span : <a href="../ParseTree/index.html#type-src_span">ParseTree.src_span</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-top_clause_gen" class="anchored"><a href="#val-top_clause_gen" class="anchor"></a><code><span><span class="keyword">val</span> top_clause_gen : <span><a href="../ParseTree/index.html#type-top_clause_shape">ParseTree.top_clause_shape</a> <span class="arrow">&#45;&gt;</span></span> <a href="../ParseTree/index.html#type-top_clause">ParseTree.top_clause</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-expr_gen" class="anchored"><a href="#val-expr_gen" class="anchor"></a><code><span><span class="keyword">val</span> expr_gen : <span><a href="../ParseTree/index.html#type-expr_shape">ParseTree.expr_shape</a> <span class="arrow">&#45;&gt;</span></span> <a href="../ParseTree/index.html#type-expr">ParseTree.expr</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-test_case" class="anchored"><a href="#val-test_case" class="anchor"></a><code><span><span class="keyword">val</span> test_case : <a href="../ParseTree/index.html#type-top_clause">ParseTree.top_clause</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-context" class="anchored"><a href="#val-context" class="anchor"></a><code><span><span class="keyword">val</span> context : <a href="#type-context">context</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-table" class="anchored"><a href="#val-table" class="anchor"></a><code><span><span class="keyword">val</span> table : <a href="#type-table">table</a></span></code></div></div></div></body></html>